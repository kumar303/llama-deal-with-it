<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dancing Llama</title>
    <script src="https://unpkg.com/preact@latest/dist/preact.umd.js"></script>
    <script src="https://unpkg.com/preact@latest/hooks/dist/hooks.umd.js"></script>
    <script src="https://unpkg.com/htm@latest/dist/htm.umd.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @keyframes dance {
        0%,
        100% {
          transform: translateY(0);
        }
        25% {
          transform: translateY(-20px);
        }
        75% {
          transform: translateY(20px);
        }
      }

      @keyframes sunglasses-fly-in {
        0% {
          transform: translate(-80px, -80px) rotate(0deg) scale(2);
          opacity: 0;
        }
        10% {
          opacity: 1;
          transform: translate(-70px, -70px) rotate(180deg) scale(1.9);
        }
        20% {
          transform: translate(-60px, -60px) rotate(360deg) scale(1.8);
        }
        30% {
          transform: translate(-50px, -50px) rotate(540deg) scale(1.7);
        }
        40% {
          transform: translate(-40px, -40px) rotate(720deg) scale(1.6);
        }
        50% {
          transform: translate(-30px, -30px) rotate(900deg) scale(1.5);
        }
        60% {
          transform: translate(-20px, -20px) rotate(1080deg) scale(1.4);
        }
        70% {
          transform: translate(-10px, -10px) rotate(1260deg) scale(1.3);
        }
        80% {
          transform: translate(-5px, -5px) rotate(1440deg) scale(1.2);
        }
        90% {
          transform: translate(-2px, -2px) rotate(1620deg) scale(1.1);
        }
        100% {
          transform: translate(0, 0) rotate(1800deg) scale(1);
          opacity: 1;
        }
      }

      @keyframes disco-ball-drop {
        0% {
          transform: translateY(-200px);
          opacity: 0;
        }
        10% {
          opacity: 1;
          transform: translateY(-180px);
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }

      @keyframes sparkle {
        0%,
        100% {
          opacity: 0;
        }
        50% {
          opacity: 1;
        }
      }

      .dancing {
        animation: dance 0.5s ease-in-out infinite;
      }

      .sunglasses {
        animation: sunglasses-fly-in 5s cubic-bezier(0.68, -0.55, 0.265, 1.55)
          forwards;
        transform-origin: center;
      }

      .disco-ball {
        animation: disco-ball-drop 5s ease-in-out forwards;
      }

      .sparkle {
        animation: sparkle 1s ease-in-out infinite;
      }

      .sparkle-1 {
        animation-delay: 0s;
      }

      .sparkle-2 {
        animation-delay: 0.3s;
      }

      .sparkle-3 {
        animation-delay: 0.6s;
      }

      .sparkle-4 {
        animation-delay: 0.9s;
      }

      @keyframes glare-sweep {
        0% {
          opacity: 0;
          transform: translateX(0);
        }
        10% {
          opacity: 0.8;
          transform: translateX(0);
        }
        50% {
          opacity: 0.8;
          transform: translateX(-1px);
        }
        90% {
          opacity: 0.8;
          transform: translateX(-1px);
        }
        100% {
          opacity: 0;
          transform: translateX(-1px);
        }
      }

      .glare {
        opacity: 0;
        animation: glare-sweep 3s ease-in-out infinite;
        animation-delay: 5s; /* Start after sunglasses land */
        animation-fill-mode: both; /* Keeps opacity:0 until animation starts */
      }

      /* Pixelated effect */
      .pixelated {
        image-rendering: pixelated;
        image-rendering: -moz-crisp-edges;
        image-rendering: crisp-edges;
      }
    </style>
  </head>
  <body class="min-h-screen bg-gray-100 flex items-center justify-center">
    <div id="app"></div>

    <script>
      const { h, render } = preact;
      const { useState } = preactHooks;
      const html = htm.bind(h);

      // Pixelated Disco Ball Component
      const PixelatedDiscoBall = () => {
        return html`
          <svg
            width="100"
            height="300"
            viewBox="0 0 10 30"
            className="pixelated disco-ball"
            style=${{
              imageRendering: "pixelated",
              position: "absolute",
              top: "-200px",
              left: "80px",
            }}
          >
            <!-- Cord extending to top -->
            <rect x="4" y="0" width="2" height="22" fill="#333333" />

            <!-- Disco ball - more round shape -->
            <!-- Top row -->
            <rect x="3" y="22" width="4" height="1" fill="#C0C0C0" />

            <!-- Second row -->
            <rect x="2" y="23" width="6" height="1" fill="#C0C0C0" />

            <!-- Middle rows -->
            <rect x="1" y="24" width="8" height="2" fill="#C0C0C0" />

            <!-- Lower row -->
            <rect x="2" y="26" width="6" height="1" fill="#C0C0C0" />

            <!-- Bottom row -->
            <rect x="3" y="27" width="4" height="1" fill="#C0C0C0" />

            <!-- Mirror tiles pattern for round effect -->
            <!-- Top section -->
            <rect x="4" y="22" width="1" height="1" fill="#FFFFFF" />

            <!-- Upper section -->
            <rect x="3" y="23" width="1" height="1" fill="#FFFFFF" />
            <rect x="5" y="23" width="1" height="1" fill="#E0E0E0" />

            <!-- Middle section -->
            <rect x="2" y="24" width="1" height="1" fill="#E0E0E0" />
            <rect x="4" y="24" width="1" height="1" fill="#FFFFFF" />
            <rect x="6" y="24" width="1" height="1" fill="#FFFFFF" />
            <rect x="8" y="24" width="1" height="1" fill="#E0E0E0" />

            <rect x="1" y="25" width="1" height="1" fill="#FFFFFF" />
            <rect x="3" y="25" width="1" height="1" fill="#E0E0E0" />
            <rect x="5" y="25" width="1" height="1" fill="#FFFFFF" />
            <rect x="7" y="25" width="1" height="1" fill="#E0E0E0" />

            <!-- Lower section -->
            <rect x="3" y="26" width="1" height="1" fill="#FFFFFF" />
            <rect x="5" y="26" width="1" height="1" fill="#E0E0E0" />

            <!-- Bottom section -->
            <rect x="4" y="27" width="1" height="1" fill="#E0E0E0" />

            <!-- Sparkles around the ball -->
            <g className="sparkle sparkle-1">
              <rect x="0" y="23" width="1" height="1" fill="#FFFF00" />
            </g>
            <g className="sparkle sparkle-2">
              <rect x="9" y="24" width="1" height="1" fill="#FFFF00" />
            </g>
            <g className="sparkle sparkle-3">
              <rect x="1" y="27" width="1" height="1" fill="#FFFF00" />
            </g>
            <g className="sparkle sparkle-4">
              <rect x="8" y="26" width="1" height="1" fill="#FFFF00" />
            </g>
          </svg>
        `;
      };

      // Pixelated Llama SVG Component
      const PixelatedLlama = ({ isDancing }) => {
        return html`
          <svg
            width="160"
            height="160"
            viewBox="0 0 16 16"
            className=${`pixelated ${isDancing ? "dancing" : ""}`}
            style=${{ imageRendering: "pixelated", overflow: "visible" }}
          >
            <!-- Llama body -->
            <rect x="4" y="8" width="8" height="6" fill="#FF8C00" />

            <!-- Llama neck -->
            <rect x="9" y="5" width="3" height="4" fill="#FF8C00" />

            <!-- Llama head -->
            <rect x="9" y="2" width="4" height="3" fill="#FF8C00" />

            <!-- Ears -->
            <rect x="10" y="1" width="1" height="1" fill="#FF8C00" />
            <rect x="12" y="1" width="1" height="1" fill="#FF8C00" />

            <!-- Legs -->
            <rect x="5" y="14" width="2" height="2" fill="#FF8C00" />
            <rect x="9" y="14" width="2" height="2" fill="#FF8C00" />

            <!-- Eye -->
            <rect x="11" y="3" width="1" height="1" fill="#000" />

            <!-- Tail -->
            <rect x="3" y="9" width="1" height="2" fill="#FF8C00" />

            <!-- Deal with it sunglasses -->
            ${isDancing &&
            html`
              <g className="sunglasses">
                <!-- Sunglasses frame (thicker, more pixelated) -->
                <rect x="9" y="3" width="5" height="1" fill="#000" />
                <!-- Bridge -->
                <rect x="11" y="2" width="1" height="1" fill="#000" />
                <!-- Left lens frame -->
                <rect x="9" y="2" width="2" height="1" fill="#000" />
                <rect x="9" y="4" width="2" height="1" fill="#000" />
                <rect x="8" y="3" width="1" height="1" fill="#000" />
                <!-- Right lens frame -->
                <rect x="12" y="2" width="2" height="1" fill="#000" />
                <rect x="12" y="4" width="2" height="1" fill="#000" />
                <rect x="14" y="3" width="1" height="1" fill="#000" />
                <!-- Left lens (black) -->
                <rect x="9" y="3" width="2" height="1" fill="#000" />
                <!-- Right lens (black) -->
                <rect x="12" y="3" width="2" height="1" fill="#000" />

                <!-- Pixelated glare effect - stays within lens boundaries -->
                <g className="glare">
                  <!-- Glare pixels that move across the lenses -->
                  <!-- Right lens glare (x:12-13, y:3) -->
                  <rect
                    x="13"
                    y="3"
                    width="1"
                    height="1"
                    fill="#666"
                    opacity="0.8"
                  />
                  <!-- Left lens glare (x:9-10, y:3) -->
                  <rect
                    x="10"
                    y="3"
                    width="1"
                    height="1"
                    fill="#666"
                    opacity="0.8"
                  />
                </g>
              </g>
            `}
          </svg>
        `;
      };

      const App = () => {
        const [isDancing, setIsDancing] = useState(false);

        const handleDanceClick = () => {
          setIsDancing(!isDancing);
        };

        return html`
          <div
            className="w-96 h-96 bg-gradient-to-br from-purple-900 to-pink-500 rounded-lg flex flex-col items-center justify-center shadow-2xl overflow-visible relative"
          >
            ${isDancing && html`<${PixelatedDiscoBall} />`}
            <${PixelatedLlama} isDancing=${isDancing} />
            <button
              onClick=${handleDanceClick}
              className="mt-8 px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-md transition-colors duration-200 shadow-lg"
            >
              ${isDancing ? "OK, stop" : "Deal with it"}
            </button>
          </div>
        `;
      };

      render(html`<${App} />`, document.getElementById("app"));
    </script>
  </body>
</html>
